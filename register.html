<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register | STEM Village</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.0/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/accessibility.css">
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="min-h-screen flex flex-col justify-center items-center bg-purple-50">
  <header class="w-full py-6 flex justify-center items-center bg-purple-600 text-white shadow">
    <h1 class="text-3xl font-bold tracking-tight">STEM Village Registration</h1>
    <button id="voice-nav" aria-label="Voice Navigation" class="ml-4 p-2 rounded-full bg-purple-500 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-300">
      <i data-feather="mic"></i>
    </button>
  </header>
  <main class="flex-1 w-full flex flex-col items-center justify-center">
    <form id="register-form" class="container max-w-md w-full bg-white rounded-lg shadow-lg p-8 mt-8 relative z-10" autocomplete="off" aria-labelledby="form-title" novalidate>
      <h2 id="form-title" class="text-2xl font-semibold text-purple-700 mb-6 text-center">Create Your Account</h2>
      <div class="mb-6 flex justify-center gap-6" role="radiogroup" aria-label="Select Role">
        <label class="flex items-center cursor-pointer">
          <input type="radio" name="role" value="student" checked class="form-radio text-purple-600" aria-checked="true">
          <span class="ml-2 text-purple-700 font-medium">Student</span>
        </label>
        <label class="flex items-center cursor-pointer">
          <input type="radio" name="role" value="teacher" class="form-radio text-purple-600" aria-checked="false">
          <span class="ml-2 text-purple-700 font-medium">Teacher</span>
        </label>
      </div>
      <div class="mb-4">
        <label for="name" class="block text-sm font-medium text-purple-700">Name</label>
        <div class="relative">
          <input type="text" id="name" name="name" required class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded" aria-required="true">
          <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="user"></i></span>
        </div>
        <div class="text-sm text-red-600 mt-1" id="error-name" aria-live="polite"></div>
      </div>
      <div class="mb-4">
        <label for="email" class="block text-sm font-medium text-purple-700">Email</label>
        <div class="relative">
          <input type="email" id="email" name="email" required class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded" aria-required="true">
          <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="mail"></i></span>
        </div>
        <div class="text-sm text-red-600 mt-1" id="error-email" aria-live="polite"></div>
      </div>
      <div class="mb-4">
        <label for="password" class="block text-sm font-medium text-purple-700">Password</label>
        <div class="relative">
          <input type="password" id="password" name="password" required minlength="8" class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded" aria-required="true">
          <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="lock"></i></span>
        </div>
        <div class="text-sm text-red-600 mt-1" id="error-password" aria-live="polite"></div>
      </div>
      <div class="mb-4">
        <label for="confirm-password" class="block text-sm font-medium text-purple-700">Confirm Password</label>
        <div class="relative">
          <input type="password" id="confirm-password" name="confirm-password" required minlength="8" class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded" aria-required="true">
          <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="check"></i></span>
        </div>
        <div class="text-sm text-red-600 mt-1" id="error-confirm-password" aria-live="polite"></div>
      </div>
      <div id="student-fields">
        <div class="mb-4">
          <label for="rollno" class="block text-sm font-medium text-purple-700">Student Roll No/ID</label>
          <div class="relative">
            <input type="text" id="rollno" name="rollno" class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded">
            <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="hash"></i></span>
          </div>
          <div class="text-sm text-red-600 mt-1" id="error-rollno" aria-live="polite"></div>
        </div>
        <div class="mb-4">
          <label for="grade" class="block text-sm font-medium text-purple-700">Grade Level</label>
          <select id="grade" name="grade" class="form-select w-full border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded">
            <option value="">Select Grade</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
          </select>
          <div class="text-sm text-red-600 mt-1" id="error-grade" aria-live="polite"></div>
        </div>
      </div>
      <div id="teacher-fields" style="display:none;">
        <div class="mb-4">
          <label for="schoolid" class="block text-sm font-medium text-purple-700">School ID Number</label>
          <div class="relative">
            <input type="text" id="schoolid" name="schoolid" class="form-input w-full pl-10 border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded">
            <span class="absolute left-3 top-2.5 text-purple-400"><i data-feather="briefcase"></i></span>
          </div>
          <div class="text-sm text-red-600 mt-1" id="error-schoolid" aria-live="polite"></div>
        </div>
        <div class="mb-4">
          <label for="subject" class="block text-sm font-medium text-purple-700">Subject Taught</label>
          <select id="subject" name="subject" class="form-select w-full border-purple-300 focus:border-purple-500 focus:ring-purple-500 rounded">
            <option value="">Select Subject</option>
            <option value="Mathematics">Mathematics</option>
            <option value="Physics">Physics</option>
            <option value="Chemistry">Chemistry</option>
            <option value="Biology">Biology</option>
            <option value="Computer Science">Computer Science</option>
            <option value="Engineering">Engineering</option>
            <option value="Other">Other</option>
          </select>
          <div class="text-sm text-red-600 mt-1" id="error-subject" aria-live="polite"></div>
        </div>
      </div>
      <div class="flex items-center mb-4">
        <input type="checkbox" id="agree" name="agree" required class="form-checkbox text-purple-600" aria-required="true">
        <label for="agree" class="ml-2 text-sm text-purple-700">I agree to the <a href="#" class="underline text-purple-600">Terms</a> and <a href="#" class="underline text-purple-600">Privacy Policy</a></label>
      </div>
      <button type="submit" class="w-full py-2 px-4 bg-purple-600 text-white font-semibold rounded hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-400 transition">Register</button>
      <div class="mt-4 text-center">
        <a href="login.html" class="text-purple-600 hover:underline">Already have an account? Login</a>
      </div>
      <div class="mt-2 text-center">
        <a href="teacher-login.html" class="text-purple-600 hover:underline">Teacher Login</a>
      </div>
    </form>
  </main>
  <script>
    feather.replace();
    // Role selection logic
    const roleRadios = document.querySelectorAll('input[name="role"]');
    const studentFields = document.getElementById('student-fields');
    const teacherFields = document.getElementById('teacher-fields');
    roleRadios.forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.value === 'student') {
          studentFields.style.display = '';
          teacherFields.style.display = 'none';
        } else {
          studentFields.style.display = 'none';
          teacherFields.style.display = '';
        }
      });
    });
    // Form validation
    document.getElementById('register-form').addEventListener('submit', function(e) {
      const role = document.querySelector('input[name="role"]:checked').value;
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirm-password').value;
      let valid = true;
      let firstInvalid = null;
      // Clear errors
      ["name","email","password","confirm-password","rollno","grade","schoolid","subject"].forEach(id => {
        document.getElementById('error-' + id)?.textContent = '';
      });
      // Name
      if (!name) {
        valid = false;
        document.getElementById('error-name').textContent = 'Name is required.';
        firstInvalid = firstInvalid || document.getElementById('name');
      }
      // Email
      if (!email.match(/^\S+@\S+\.\S+$/)) {
        valid = false;
        document.getElementById('error-email').textContent = 'Valid email is required.';
        firstInvalid = firstInvalid || document.getElementById('email');
      }
      // Password
      if (password.length < 8 || !/[A-Z]/.test(password) || !/[a-z]/.test(password) || !/[0-9]/.test(password)) {
        valid = false;
        document.getElementById('error-password').textContent = 'Password must be at least 8 characters and include uppercase, lowercase, and a number.';
        firstInvalid = firstInvalid || document.getElementById('password');
      }
      // Confirm Password
      if (password !== confirmPassword) {
        valid = false;
        document.getElementById('error-confirm-password').textContent = 'Passwords do not match.';
        firstInvalid = firstInvalid || document.getElementById('confirm-password');
      }
      // Role-specific fields
      if (role === 'student') {
        if (!document.getElementById('rollno').value.trim()) {
          valid = false;
          document.getElementById('error-rollno').textContent = 'Student Roll No/ID is required.';
          firstInvalid = firstInvalid || document.getElementById('rollno');
        }
        if (!document.getElementById('grade').value) {
          valid = false;
          document.getElementById('error-grade').textContent = 'Grade level is required.';
          firstInvalid = firstInvalid || document.getElementById('grade');
        }
      } else {
        if (!document.getElementById('schoolid').value.trim()) {
          valid = false;
          document.getElementById('error-schoolid').textContent = 'School ID Number is required.';
          firstInvalid = firstInvalid || document.getElementById('schoolid');
        }
        if (!document.getElementById('subject').value) {
          valid = false;
          document.getElementById('error-subject').textContent = 'Subject taught is required.';
          firstInvalid = firstInvalid || document.getElementById('subject');
        }
      }
      // Terms
      if (!document.getElementById('agree').checked) {
        valid = false;
        alert('You must agree to the Terms and Privacy Policy.');
        firstInvalid = firstInvalid || document.getElementById('agree');
      }
      if (!valid) {
        e.preventDefault();
        if (firstInvalid) firstInvalid.focus();
      }
    });
    // Voice navigation placeholder
    document.getElementById('voice-nav').addEventListener('click', function() {
      alert('Voice navigation coming soon!');
    });
    // Accessibility: focus management
    document.getElementById('register-form').addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && e.target.tagName === 'INPUT') {
        const inputs = Array.from(this.querySelectorAll('input, select'));
        const idx = inputs.indexOf(e.target);
        if (idx > -1 && idx < inputs.length - 1) {
          inputs[idx + 1].focus();
          e.preventDefault();
        }
      }
    });
  </script>
</body>
</html>
